<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<title>Visby Soltipp – 3D-illustration</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
html, body {
  margin: 0;
  height: 100%;
  overflow: hidden;
  background: #041b25;
  font-family: Arial, sans-serif;
}
canvas { display: block; }
</style>
</head>

<body>

<!-- Three.js r149 (stabil klassisk version) -->
<script src="https://cdn.jsdelivr.net/npm/three@0.149.0/build/three.min.js"></script>

<script>
console.log("THREE version:", THREE.REVISION);

// --------------------------------------------------
// SCEN
// --------------------------------------------------
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x041b25);

// --------------------------------------------------
// KAMERA
// --------------------------------------------------
const camera = new THREE.PerspectiveCamera(
  60,
  window.innerWidth / window.innerHeight,
  0.1,
  500
);
camera.position.set(20, 25, 25);
camera.lookAt(0, 0, 0);

// --------------------------------------------------
// RENDERER
// --------------------------------------------------
const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setPixelRatio(2);
renderer.shadowMap.enabled = true;
document.body.appendChild(renderer.domElement);

// --------------------------------------------------
// LJUS
// --------------------------------------------------
scene.add(new THREE.AmbientLight(0xffffff, 0.4));

const sun = new THREE.DirectionalLight(0xfff3cc, 1);
sun.position.set(30, 40, 20);
sun.castShadow = true;
scene.add(sun);

// --------------------------------------------------
// MARK
// --------------------------------------------------
const ground = new THREE.Mesh(
  new THREE.PlaneGeometry(80, 80),
  new THREE.MeshStandardMaterial({ color: 0x9efc8a })
);
ground.rotation.x = -Math.PI / 2;
ground.receiveShadow = true;
scene.add(ground);

// --------------------------------------------------
// MATERIAL
// --------------------------------------------------
const panelMaterial = new THREE.MeshStandardMaterial({
  color: 0x1f2937,
  roughness: 0.4,
  metalness: 0.6
});

const standMaterial = new THREE.MeshStandardMaterial({
  color: 0x9ca3af
});

// --------------------------------------------------
// SOLPARK
// --------------------------------------------------
function createPanel(x, z) {
  const panel = new THREE.Mesh(
    new THREE.BoxGeometry(6, 0.2, 3),
    panelMaterial
  );
  panel.position.set(x, 1.4, z);
  panel.rotation.x = -Math.PI / 10;
  panel.castShadow = true;
  panel.receiveShadow = true;
  scene.add(panel);
}

function createStand(x, z) {
  const stand = new THREE.Mesh(
    new THREE.CylinderGeometry(0.08, 0.1, 1.2),
    standMaterial
  );
  stand.position.set(x, 0.6, z);
  stand.castShadow = true;
  scene.add(stand);
}

function createRow(z) {
  for (let x of [-6, -3, 0, 3, 6]) {
    createPanel(x, z);
    createStand(x - 1.4, z);
    createStand(x + 1.4, z);
  }
}

// 6 rader solceller
for (let z of [-10, -6, -2, 2, 6, 10]) {
  createRow(z);
}

// --------------------------------------------------
// BATTERIKONTAINER
// --------------------------------------------------
const battery = new THREE.Mesh(
  new THREE.BoxGeometry(4, 2.5, 2),
  new THREE.MeshStandardMaterial({ color: 0xf9fafb })
);
battery.position.set(-12, 1.25, 0);
battery.castShadow = true;
battery.receiveShadow = true;
scene.add(battery);

// --------------------------------------------------
// ANIMATION
// --------------------------------------------------
function animate() {
  requestAnimationFrame(animate);

  // Lugn rotation för överblick
  scene.rotation.y += 0.001;

  renderer.render(scene, camera);
}
animate();

// --------------------------------------------------
// RESIZE
// --------------------------------------------------
window.addEventListener('resize', () => {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>

</body>
</html>
